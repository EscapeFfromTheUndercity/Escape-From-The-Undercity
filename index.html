<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Escape from the Undercity</title>
  <style>
    /* Header / nav â€” same as other pages */
    body{background:#000;color:#fff;font-family:monospace;margin:0}
    header{display:flex;flex-direction:column;align-items:center;text-align:center;padding-top:40px}
    h1{font-size:2.5rem}
    nav{margin-top:10px}
    nav a{color:#fff;font-size:1rem;margin:0 10px;text-decoration:none}
    nav a:hover{text-decoration:underline}
    @media(min-width:600px){nav a{font-size:1.6rem;padding:8px 14px}}

    /* Subscribe */
    .subscribe{margin:40px 0 10px;text-align:center}
    .subscribe h3{color:yellow;font-size:1.6rem;margin:0 0 10px}
    .subscribe form{display:inline-flex;align-items:center;gap:8px}
    .subscribe input[type="email"]{
      padding:10px;font-size:1rem;font-family:monospace;
      border:1px solid #ccc;border-radius:4px;width:240px;
      background:#fff;color:#000;
    }
    .subscribe button{
      padding:10px 16px;font-size:1rem;font-family:monospace;
      border:none;border-radius:4px;background:#3da1ff;color:#000;cursor:pointer;
    }
    .subscribe button:hover{background:#2c8fe6}

    /* GIF sizing */
    .hero{display:block;margin:24px auto;width:85vw;max-width:1200px;height:auto}

    /* Music toggle button (same as About) */
    #musicToggle{
      position:fixed;left:50%;bottom:22px;transform:translateX(-50%);
      font-family:monospace;font-size:1rem;
      background:#222;color:#fff;border:1px solid #555;
      padding:10px 18px;cursor:pointer;border-radius:6px;z-index:10;
    }
  </style>
</head>
<body>
  <header>
    <h1>Escape from the Undercity</h1>
    <nav>
      <a href="index.html">Home</a> |
      <a href="comic.html">Comic</a> |
      <a href="about.html">About</a> |
      <a href="shop.html">Shop</a>
    </nav>
  </header>

  <div class="subscribe">
    <h3>Join the Resistance</h3>
    <form action="https://escapefromtheundercity.substack.com/subscribe" method="get" target="_blank" rel="noopener">
      <input type="email" name="email" placeholder="Your email..." required />
      <button type="submit">Subscribe</button>
    </form>
  </div>

  <img src="Smoke.gif" alt="Rising smoke over the Undercity" class="hero" />

  <!-- Music (exactly as About page) -->
  <audio id="bgm" loop preload="auto">
    <source src="escape_loop_theme_9_Aug_25.ogg" type="audio/ogg">
    Your browser does not support the audio element.
  </audio>

  <button id="musicToggle" aria-pressed="true">ðŸ”Š Music: On</button>

  <script>
    // --- Music toggle (same as About page) ---
    const audio = document.getElementById('bgm');
    const btn   = document.getElementById('musicToggle');
    const KEY = 'siteBgmPref';
    const pref = localStorage.getItem(KEY);
    function setButton(isOn){
      btn.textContent = isOn ? 'ðŸ”Š Music: On' : 'ðŸ”‡ Music: Off';
      btn.setAttribute('aria-pressed', isOn ? 'true' : 'false');
    }
    async function startMusic(){
      if (pref === 'off'){ setButton(false); return; }
      try{ await audio.play(); setButton(true); localStorage.setItem(KEY,'on'); }
      catch{ setButton(false); }
    }
    btn.addEventListener('click', async ()=>{
      if (audio.paused){
        try{ await audio.play(); setButton(true); localStorage.setItem(KEY,'on'); }catch{}
      }else{
        audio.pause(); setButton(false); localStorage.setItem(KEY,'off');
      }
    });
    document.addEventListener('DOMContentLoaded', startMusic);
  </script>
</body>
</html>
